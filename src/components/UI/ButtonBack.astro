---
/**
 * Back Button Component
 * A clickable button with a left caret icon for navigation back
 * 
 * Props:
 * - size: Icon size token (default: 'md' for 24px, can be 'xs' for 16px)
 * - opacity: Custom opacity value (default: 0.7)
 * - ariaLabel: Accessibility label
 * - disabled: Whether the button is disabled
 * 
 * States:
 * - Default: Faded icon (70% opacity or custom)
 * - Hover: Primary purple color (full opacity)
 * - Active: Slightly smaller (scale 0.98) to provide click feedback
 * - Focus: 2px faded border with outline
 * - Disabled: 40% opacity, not clickable
 */

import IconCaretLeft from '../icons/navigation/IconCaretLeft.astro';

export interface Props {
  size?: 'xs' | 'sm' | 'md' | 'lg';
  opacity?: number;
  ariaLabel?: string;
  disabled?: boolean;
}

const { 
  size = 'md',
  opacity = 0.7,
  ariaLabel = 'Back',
  disabled = false
} = Astro.props;

// Map size prop to pixel values
const sizeMap = {
  'xs': '16px',   // 16px (using --icon-sm token value)
  'sm': '20px',   // 20px
  'md': '24px',   // 24px (using --icon-md token value)
  'lg': '32px',   // 32px (using --icon-lg token value)
};

const buttonSize = sizeMap[size];
---

<button 
  class="button-back" 
  type="button"
  aria-label={ariaLabel}
  disabled={disabled}
  style={`--button-size: ${buttonSize}; --button-opacity: ${opacity};`}
>
  <span class="icon-wrapper">
    <IconCaretLeft />
  </span>
</button>

<style>
  .button-back {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--button-size);
    height: var(--button-size);
    padding: 0;
    background: transparent;
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .icon-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    color: var(--on-surface-light-regular);
    opacity: var(--button-opacity);
    transition: all 0.2s ease;
  }

  .icon-wrapper :global(svg) {
    width: 100%;
    height: 100%;
  }

  /* Hover state - full opacity, primary purple color */
  .button-back:hover:not(:focus-visible):not(:disabled) .icon-wrapper {
    color: var(--on-surface-light-primary);
    opacity: 1;
  }

  /* Active state - provides click feedback */
  .button-back:active:not(:disabled) {
    transform: scale(0.98);
  }

  /* Focus state - 2px faded border with outline */
  .button-back:focus-visible {
    outline: none;
  }

  .button-back:focus-visible::after {
    content: '';
    position: absolute;
    inset: 0;
    border: var(--border-lg) solid var(--on-surface-light-faded);
    border-radius: var(--radius-md);
    pointer-events: none;
  }

  /* Disabled state */
  .button-back:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }

  .button-back:disabled .icon-wrapper {
    opacity: 0.4;
  }
</style>