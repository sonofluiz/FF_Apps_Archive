---
/**
 * Modal Component
 * Dialog/overlay component with header (badge, title, close button) and body text
 * 
 * Props:
 * - title: Heading text (default: "Title")
 * - body: Body content text (default: lorem ipsum)
 * - showBadge: Whether to show notification badge (default: true)
 * 
 * Structure:
 * - Header with notification badge, H2 title, and close button
 * - Body text area with scrollable content
 * 
 * Design System Notes:
 * - Background: --surface-light-mid (white)
 * - Border: --on-surface-light-border-low with shadow
 * - Border radius: --radius-sm (4px)
 * - Padding: 32px
 * - Gap: 12px between header and body
 * - Header gap: 8px between badge, title, close button
 * 
 * Interactive States:
 * - Close button has hover/focus/active states
 * - Focus visible border on modal container
 */

import H2 from './H2.astro';
import BadgeNotification from './BadgeNotification.astro';
import ButtonClose from './ButtonClose.astro';

export interface Props {
  title?: string;
  body?: string;
  showBadge?: boolean;
}

const { 
  title = "Title",
  body = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum enim lectus, mollis sed mattis egestas, euismod a lacus. Integer nec diam pulvinar, commodo ex et, venenatis lacus. Phasellus nec tellus a turpis vulputate porttitor. Nunc laoreet scelerisque erat ac sollicitudin. Sed viverra ligula eget dui bibendum, eget fermentum arcu tempus. Donec ac nisi lobortis est suscipit vestibulum. Duis non erat varius, condimentum lorem nec, faucibus sapien",
  showBadge = true
} = Astro.props;
---

<div class="modal">
  <!-- Border overlay with shadow -->
  <div class="border-overlay" aria-hidden="true"></div>
  
  <!-- Header: Badge + H2 + Close Button -->
  <div class="modal-header">
    {showBadge && (
      <div class="badge-wrapper">
        <BadgeNotification variant="warning" />
      </div>
    )}
    
    <div class="title-wrapper">
      <H2 text={title} />
    </div>
    
    <div class="close-wrapper">
      <ButtonClose size="xs" ariaLabel="Close modal" />
    </div>
  </div>
  
  <!-- Body Text -->
  <p class="modal-body">{body}</p>
</div>

<style>
  /* ========================================
     MODAL CONTAINER
     ======================================== */
  .modal {
    position: relative;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-12);
    width: 100%;
    height: auto;
    padding: var(--spacing-32);
    background: var(--surface-light-mid);
    border-radius: var(--radius-sm);
  }

  /* Border overlay with shadow */
  .border-overlay {
    position: absolute;
    inset: 0;
    border: var(--border-sm) solid var(--on-surface-light-border-low);
    border-radius: var(--radius-sm);
    box-shadow: 0px 1px 1px 0px rgba(0, 0, 0, 0.1);
    pointer-events: none;
  }

  /* ========================================
     MODAL HEADER
     ======================================== */
  .modal-header {
    display: flex;
    align-items: baseline;
    gap: var(--spacing-8);
    width: 100%;
    flex-shrink: 0;
  }

  /* Badge wrapper - override size to 12px */
  .badge-wrapper {
    flex-shrink: 0;
    width: 12px;
    height: 12px;
  }

  /* Scale up the badge to 12px (from default 8px) */
  .badge-wrapper :global(.badge-notification) {
    width: 12px !important;
    height: 12px !important;
  }

  /* Ensure SVG scales properly */
  .badge-wrapper :global(.badge-svg) {
    display: block;
    width: 100% !important;
    height: 100% !important;
  }

  /* Title wrapper - flex grow to take available space */
  .title-wrapper {
    flex: 1 1 auto;
    min-width: 0;
  }

  /* Override H2 display to inline-block for proper alignment */
  .title-wrapper :global(.heading) {
    display: inline-block;
  }

  /* Close button wrapper */
  .close-wrapper {
    flex-shrink: 0;
  }

  /* ========================================
     MODAL BODY
     ======================================== */
  .modal-body {
    /* Typography - Inter Regular, 14px/22px */
    font-family: var(--font-inter);
    font-weight: var(--font-weight-regular);
    font-size: 14px;
    line-height: 22px;
    letter-spacing: normal;
    font-style: normal;
    
    /* Color */
    color: var(--on-surface-light-regular);
    
    /* Layout */
    width: 100%;
    white-space: pre-wrap;
    margin: 0;
    padding: 0;
    flex-shrink: 0;
  }
</style>